<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ASSIGN All-in-one function — assign.wrapper • ASSIGN</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="ASSIGN All-in-one function — assign.wrapper" />

<meta property="og:description" content="The assign.wrapper function integrates the assign.preprocess, assign.mcmc,
assign.summary, assign.output, assign.cv.output functions into one wrapper
function." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ASSIGN</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.21.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/ASSIGN.vignette.html">Primer</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/compbiomed/ASSIGN">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>ASSIGN All-in-one function</h1>
    
    <div class="hidden name"><code>assign.wrapper.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The assign.wrapper function integrates the assign.preprocess, assign.mcmc,
assign.summary, assign.output, assign.cv.output functions into one wrapper
function.</p>
    
    </div>

    <pre class="usage"><span class='fu'>assign.wrapper</span>(<span class='kw'>trainingData</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>testData</span>, <span class='no'>trainingLabel</span>,
  <span class='kw'>testLabel</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>geneList</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>anchorGenes</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>excludeGenes</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n_sigGene</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>adaptive_B</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>adaptive_S</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>mixture_beta</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>outputDir</span>, <span class='kw'>p_beta</span> <span class='kw'>=</span> <span class='fl'>0.01</span>,
  <span class='kw'>theta0</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>theta1</span> <span class='kw'>=</span> <span class='fl'>0.9</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>2000</span>, <span class='kw'>burn_in</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>sigma_sZero</span> <span class='kw'>=</span> <span class='fl'>0.01</span>, <span class='kw'>sigma_sNonZero</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>S_zeroPrior</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>pctUp</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>geneselect_iter</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>geneselect_burn_in</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>outputSignature_convergence</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>ECM</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>progress_bar</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>override_S_matrix</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>trainingData</th>
      <td><p>The genomic measure matrix of training samples (i.g.,
gene expression matrix). The dimension of this matrix is probe number x
sample number. The default is NULL.</p></td>
    </tr>
    <tr>
      <th>testData</th>
      <td><p>The genomic measure matrix of test samples (i.g., gene
expression matrix). The dimension of this matrix is probe number x sample
number.</p></td>
    </tr>
    <tr>
      <th>trainingLabel</th>
      <td><p>The list linking the index of each training sample to a
specific group it belongs to. See examples for more information.</p></td>
    </tr>
    <tr>
      <th>testLabel</th>
      <td><p>The vector of the phenotypes/labels of the test samples.
The default is NULL.</p></td>
    </tr>
    <tr>
      <th>geneList</th>
      <td><p>The list that collects the signature genes of one/multiple
pathways. Every component of this list contains the signature genes
associated with one pathway. The default is NULL.</p></td>
    </tr>
    <tr>
      <th>anchorGenes</th>
      <td><p>A list of genes that will be included in the signature
even if they are not chosen during gene selection.</p></td>
    </tr>
    <tr>
      <th>excludeGenes</th>
      <td><p>A list of genes that will be excluded from the signature
even if they are chosen during gene selection.</p></td>
    </tr>
    <tr>
      <th>n_sigGene</th>
      <td><p>The vector of the signature genes to be identified for one
pathway. n_sigGene needs to be specified when geneList is set NULL. The
default is NA. See examples for more information.</p></td>
    </tr>
    <tr>
      <th>adaptive_B</th>
      <td><p>Logicals. If TRUE, the model adapts the
baseline/background (B) of genomic measures for the test samples. The
default is TRUE.</p></td>
    </tr>
    <tr>
      <th>adaptive_S</th>
      <td><p>Logicals. If TRUE, the model adapts the signatures (S) of
genomic measures for the test samples. The default is FALSE.</p></td>
    </tr>
    <tr>
      <th>mixture_beta</th>
      <td><p>Logicals. If TRUE, elements of the pathway activation
matrix are modeled by a spike-and-slab mixture distribution. The default is
TRUE.</p></td>
    </tr>
    <tr>
      <th>outputDir</th>
      <td><p>The path to the directory to save the output files. The
path needs to be quoted in double quotation marks.</p></td>
    </tr>
    <tr>
      <th>p_beta</th>
      <td><p>p_beta is the prior probability of a pathway being activated
in individual test samples. The default is 0.01.</p></td>
    </tr>
    <tr>
      <th>theta0</th>
      <td><p>The prior probability for a gene to be significant, given that
the gene is NOT defined as "significant" in the signature gene lists
provided by the user. The default is 0.05.</p></td>
    </tr>
    <tr>
      <th>theta1</th>
      <td><p>The prior probability for a gene to be significant, given that
the gene is defined as "significant" in the signature gene lists provided by
the user. The default is 0.9.</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>The number of iterations in the MCMC. The default is 2000.</p></td>
    </tr>
    <tr>
      <th>burn_in</th>
      <td><p>The number of burn-in iterations. These iterations are
discarded when computing the posterior means of the model parameters. The
default is 1000.</p></td>
    </tr>
    <tr>
      <th>sigma_sZero</th>
      <td><p>Each element of the signature matrix (S) is modeled by a
spike-and-slab mixture distribution. Sigma_sZero is the variance of the
spike normal distribution. The default is 0.01.</p></td>
    </tr>
    <tr>
      <th>sigma_sNonZero</th>
      <td><p>Each element of the signature matrix (S) is modeled by
a spike-and-slab mixture distribution. Sigma_sNonZero is the variance of
the slab normal distribution. The default is 1.</p></td>
    </tr>
    <tr>
      <th>S_zeroPrior</th>
      <td><p>Logicals. If TRUE, the prior distribution of signature
follows a normal distribution with mean zero. The default is TRUE.</p></td>
    </tr>
    <tr>
      <th>pctUp</th>
      <td><p>By default, ASSIGN bayesian gene selection chooses the
signature genes with an equal fraction of genes that increase with pathway
activity and genes that decrease with pathway activity. Use the pctUp
parameter to modify this fraction. Set pctUP to NULL to select the most
significant genes, regardless of direction. The default is 0.5</p></td>
    </tr>
    <tr>
      <th>geneselect_iter</th>
      <td><p>The number of iterations for bayesian gene selection.
The default is 500.</p></td>
    </tr>
    <tr>
      <th>geneselect_burn_in</th>
      <td><p>The number of burn-in iterations for bayesian gene
selection. The default is 100</p></td>
    </tr>
    <tr>
      <th>outputSignature_convergence</th>
      <td><p>Create a pdf of the MCMC chain. The
default is FALSE.</p></td>
    </tr>
    <tr>
      <th>ECM</th>
      <td><p>Logicals. If TRUE, ECM algorithm, rather than Gibbs sampling, is
applied to approximate the model parameters. The default is FALSE.</p></td>
    </tr>
    <tr>
      <th>progress_bar</th>
      <td><p>Display a progress bar for MCMC and gene selection.
Default is TRUE.</p></td>
    </tr>
    <tr>
      <th>override_S_matrix</th>
      <td><p>Replace the S_matrix created by assign.preprocess
with the matrix provided in override_S_matrix. This can be used to indicate
the expected directions of genes in a signature if training data is not
provided.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The assign.wrapper returns one/multiple pathway activity for each
individual training sample and test sample, scatter plots of pathway
activity for each individual pathway in the training and test data,
heatmap plots for gene expression signatures for each individual pathway,
heatmap plots for the gene expression of the prior and posterior
signatures (if adaptive_S equals TRUE) of each individual pathway in the test
data</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The assign.wrapper function is an all-in-one function which outputs the
necessary results for basic users. For users who need more
intermediate results for model diagnosis, it is better to run the
assign.preprocess, assign.mcmc, assign.convergence, assign.summary functions
separately and extract the output values from the returned list objects of
those functions.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>trainingData1</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>testData1</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>geneList1</span>)

<span class='no'>trainingLabel1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>bcat</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>e2f3</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>myc</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>10</span>,
                                      <span class='kw'>ras</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>src</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>10</span>),
                       <span class='kw'>bcat</span> <span class='kw'>=</span> <span class='fl'>11</span>:<span class='fl'>19</span>, <span class='kw'>e2f3</span> <span class='kw'>=</span> <span class='fl'>20</span>:<span class='fl'>28</span>, <span class='kw'>myc</span><span class='kw'>=</span> <span class='fl'>29</span>:<span class='fl'>38</span>, <span class='kw'>ras</span> <span class='kw'>=</span> <span class='fl'>39</span>:<span class='fl'>48</span>,
                       <span class='kw'>src</span> <span class='kw'>=</span> <span class='fl'>49</span>:<span class='fl'>55</span>)
<span class='no'>testLabel1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"subtypeA"</span>,<span class='st'>"subtypeB"</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>53</span>,<span class='fl'>58</span>))

<span class='fu'>assign.wrapper</span>(<span class='kw'>trainingData</span><span class='kw'>=</span><span class='no'>trainingData1</span>, <span class='kw'>testData</span><span class='kw'>=</span><span class='no'>testData1</span>,
               <span class='kw'>trainingLabel</span><span class='kw'>=</span><span class='no'>trainingLabel1</span>, <span class='kw'>testLabel</span><span class='kw'>=</span><span class='no'>testLabel1</span>,
               <span class='kw'>geneList</span><span class='kw'>=</span><span class='no'>geneList1</span>, <span class='kw'>adaptive_B</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>adaptive_S</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
               <span class='kw'>mixture_beta</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>outputDir</span><span class='kw'>=</span><span class='no'>tempdir</span>, <span class='kw'>p_beta</span><span class='kw'>=</span><span class='fl'>0.01</span>,
               <span class='kw'>theta0</span><span class='kw'>=</span><span class='fl'>0.05</span>, <span class='kw'>theta1</span><span class='kw'>=</span><span class='fl'>0.9</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='fl'>20</span>, <span class='kw'>burn_in</span><span class='kw'>=</span><span class='fl'>10</span>)</div><div class='output co'>#&gt; <span class='message'>Performing QC on the input data...</span></div><div class='output co'>#&gt; <span class='message'>Generating starting/prior values for model parameters...</span></div><div class='output co'>#&gt; <span class='message'>Estimating model parameters in the training dataset...</span></div><div class='output co'>#&gt; <span class='message'>Start Gibbs sampling...</span></div><div class='output co'>#&gt; <span class='message'>| 0%                                  50%                                 100% |</span></div><div class='output co'>#&gt; <span class='message'>Estimating model parameters in the test dataset...</span></div><div class='output co'>#&gt; <span class='message'>Start Gibbs sampling...</span></div><div class='output co'>#&gt; <span class='message'>| 0%                                  50%                                 100% |</span></div><div class='output co'>#&gt; <span class='message'>Outputing results...</span></div><div class='input'>
</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Ying Shen and W. Evan Johnson</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Ying Shen, Andrea H. Bild, W. Evan Johnson, Mumtehena Rahman, David Jenkins.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

